<div style="font-size: 1.5rem;">
  <a href="./README.md">ä¸­æ–‡</a> |
  <a href="./docs/readme_en.md">English</a>
</div>
</br>

<h1 align="center">OpenTextClassification</h1>
<div align="center">
  <a href="https://github.com/catqaq/OpenTextClassification">
    <img src="https://pic4.zhimg.com/80/v2-f63d74cf9859eea57b0a78c9da00c9f3_720w.webp" alt="Logo" height="210">
  </a>

  <p align="center">
    <h3>Open text classification for you, Start your NLP journey</h3>
      <a href="https://github.com/catqaq/OpenTextClassification/graphs/contributors">
        <img alt="GitHub Contributors" src="https://img.shields.io/github/contributors/catqaq/OpenTextClassification" />
      </a>
      <a href="https://github.com/kaixindelele/ChatPaper/issues">
        <img alt="Issues" src="https://img.shields.io/github/issues/catqaq/OpenTextClassification?color=0088ff" />
      </a>
      <a href="https://github.com/catqaq/OpenTextClassification/pulls">
        <img alt="GitHub pull requests" src="https://img.shields.io/github/issues-pr/catqaq/OpenTextClassification?color=0088ff" />
      <a href="https://github.com/catqaq/OpenTextClassification/stargazers">
        <img alt="GitHub stars" src="https://img.shields.io/github/stars/catqaq/OpenTextClassification?color=ccf" />
      </a>
      <br/>
      <em>å¼€æºå®ç° / ç®€å• / å…¨é¢ / å®è·µ </em>
      <br/>
      <a href="https://zhuanlan.zhihu.com/p/596112080/"><strong>æ–‡ç« è§£è¯»</strong></a>
        Â·
      <a href="https://zhuanlan.zhihu.com/p/596112080"><strong>è§†é¢‘è§£è¯»</strong></a>
    </p>



 </p>
</div>

> **åŠŸèƒ½å…è´¹ï¼Œä»£ç å¼€æºï¼Œå¤§å®¶æ”¾å¿ƒä½¿ç”¨ï¼Œæ¬¢è¿è´¡çŒ®ï¼**


- [ğŸ’¥æœ€æ–°è®¯æ¯](#æœ€æ–°è®¯æ¯)
- [ğŸ’«å¼€å‘è®¡åˆ’](#å¼€å‘è®¡åˆ’)
- [â›ï¸ä½¿ç”¨æ­¥éª¤](#ä½¿ç”¨æ­¥éª¤)
- [ğŸ“„è¿è¡Œç¤ºä¾‹](#è¿è¡Œç¤ºä¾‹)
- [ğŸ“„ç»“æœå±•ç¤º](#ç»“æœå±•ç¤º)
- [ğŸ› ï¸å¸¸è§æŠ¥é”™](#å¸¸è§æŠ¥é”™)
- [ğŸ’å‚è€ƒèµ„æ–™&è‡´è°¢](#å‚è€ƒèµ„æ–™&è‡´è°¢)
- [ğŸŒŸèµåŠ©æˆ‘ä»¬](#èµåŠ©æˆ‘ä»¬)
- [ğŸŒˆStarchart](#Starchart)
- [ğŸ†Contributors](#Contributors)




## æœ€æ–°è®¯æ¯

- 2023/03/23ï¼šOpenTextClassification V0.0.1ç‰ˆæ­£å¼å¼€æºï¼Œç‰ˆæœ¬ç‰¹æ€§ï¼š
  - æ”¯æŒä¸­è‹±åŒè¯­çš„æ–‡æœ¬åˆ†ç±»
  - æ”¯æŒå¤šç§æ–‡æœ¬åˆ†ç±»æ¨¡å‹ï¼šä¼ ç»Ÿæœºå™¨å­¦ä¹ æµ…å±‚æ¨¡å‹ã€æ·±åº¦å­¦ä¹ æ¨¡å‹å’Œtransformersç±»æ¨¡å‹
  - æ”¯æŒå¤šæ ‡ç­¾æ–‡æœ¬åˆ†ç±»
  - æ”¯æŒå¤šç§embeddingæ–¹å¼ï¼šinner/outer/random

## å¼€å‘è®¡åˆ’

OpenTextClassificationé¡¹ç›®ä¸ºOpenNLPè®¡åˆ’çš„ç¬¬ä¸€ä¸ªæ­£å¼çš„å¼€æºé¡¹ç›®ï¼Œæ—¨åœ¨Open NLP for everyoneï¼åœ¨ä»¥ChatGPT/GPT4ä¸ºä»£è¡¨çš„LLMsæ—¶ä»£ï¼Œåœ¨è¢«OpenAIå·æ­»ä¹‹å‰ï¼Œåšä¸€ç‚¹æœ‰æ„ä¹‰çš„äº‹æƒ…ï¼æœªæ¥æœ‰ä¸€å¤©ï¼Œç­‰åˆ°GPT-Xå‘å¸ƒçš„æ—¶å€™ï¼Œæˆ–è®¸æœ‰äººä¼šè¯´NLPä¸å­˜åœ¨äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¯æ˜æœ‰äººæ›¾æ¥è¿‡ï¼



## ä½¿ç”¨æ­¥éª¤

1.å…‹éš†æœ¬é¡¹ç›®

`git clone https://github.com/catqaq/OpenTextClassification.git`

2.æ•°æ®é›†ä¸‹è½½å’Œé¢„å¤„ç†

æœ‰ç©ºæˆ‘å†æ¥è¡¥ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œæš‚æ—¶è¯·è‡ªè¡Œå¤„ç†æˆ–è€…å‚è€ƒpreprocessing.pyã€‚

æœ€å¥½å°†æ•°æ®ç»Ÿä¸€æ”¾åˆ°dataç›®å½•ä¸‹ï¼Œæ¯”å¦‚data/dbpediaï¼Œç„¶ååˆ†3ä¸ªå­ç›®å½•ï¼Œinputå­˜æ”¾åŸå§‹æ•°æ®é›†ï¼ˆä½ ä¸‹è½½çš„æ•°æ®é›†ï¼‰ï¼Œdataå­˜æ”¾é¢„å¤„ç†åçš„æ ¼å¼åŒ–çš„æ•°æ®é›†ï¼ˆtext-labelæ ¼å¼ï¼‰ï¼Œsaved_dictå­˜æ”¾è®­ç»ƒç»“æœï¼ˆæ¨¡å‹å’Œæ—¥å¿—ç­‰ï¼‰ã€‚

3.è¿è¡Œç¤ºä¾‹

ç»è¿‡æµ‹è¯•çš„å¼€å‘ç¯å¢ƒå¦‚ä¸‹ï¼Œä»…ä¾›å‚è€ƒï¼Œå·®ä¸å¤šçš„ç¯å¢ƒåº”è¯¥éƒ½å¯ä»¥è¿è¡Œã€‚

- pythonï¼š3.6/3.7
- torchï¼š1.6.0
- transformersï¼š4.18.0
- torchtextï¼š0.7.0
- scikit-learnï¼š 0.24.2
- tensorboardXï¼š2.6
- nltkï¼š3.6.7
- numpyï¼š1.18.5
- pandasï¼š1.1.5



æ ¹æ®è‡ªå·±çš„éœ€è¦é€‰æ‹©æ¨¡å—è¿è¡Œï¼Œè¯¦è§ä¸‹ä¸€èŠ‚ã€‚

` python run.py`

## è¿è¡Œç¤ºä¾‹

1.è¿è¡ŒDNN/transformersç±»æ¨¡å‹åšæ–‡æœ¬åˆ†ç±»

` python run.py`

2.è¿è¡Œä¼ ç»Ÿæµ…å±‚æœºå™¨å­¦ä¹ æ¨¡å‹åšæ–‡æœ¬åˆ†ç±»

`python run_shallow.py`

3.è¿è¡ŒDNN/transformersç±»æ¨¡å‹åšå¤šæ ‡ç­¾æ–‡æœ¬åˆ†ç±»

`python run_multi_label.py`



ä¸‹è¡¨æ˜¯ç›´æ¥è¿è¡Œdemoçš„å‚è€ƒç»“æœï¼š

è¿è¡Œç¯å¢ƒï¼špython3.6 + T4

| demo               | æ•°æ®é›†      | ç¤ºä¾‹æ¨¡å‹ | Acc    | è€—æ—¶      | å¤‡æ³¨               |
| ------------------ | ----------- | -------- | ------ | --------- | ------------------ |
| run.py             | THUCNews/cn | TextCNN  | 89.94% | ~2mins    |                    |
| run_multi_label.py | rcv1/en     | bert     | 61.04% | ~40mins   | å…¶ä»–æŒ‡æ ‡è§è¿è¡Œç»“æœ |
| run_shallow.py     | THUCNews/cn | NB       | 89.44% | 105.34 ms |                    |

## ç»“æœå±•ç¤ºï¼šå¾…å®Œå–„

ç¬”è€…æä¾›äº†ä»æµ…åˆ°æ·±å†åˆ°å¤šæ ‡ç­¾çš„è¯¦ç»†å®éªŒç»“æœï¼Œå¯ä¾›å¤§å®¶å‚è€ƒã€‚ä½†å—é™äºæ—¶é—´å’Œç®—åŠ›ï¼Œå¾ˆå¤šå®éªŒå¯èƒ½æœªè¾¾åˆ°æœ€ä¼˜ï¼Œæœ›çŸ¥æ‚‰ï¼å› æ­¤ï¼Œéå¸¸æ¬¢è¿å¤§å®¶ç§¯æè´¡çŒ®ï¼Œè¡¥å……ç›¸å…³å®éªŒã€ä»£ç å’Œæ–°çš„æ¨¡å‹ç­‰ç­‰ï¼Œä¸€èµ·å»ºè®¾OpenTextClassificationã€‚

æš‚æ—¶åªæä¾›éƒ¨åˆ†æ±‡æ€»çš„ç»“æœï¼Œè¯¦ç»†çš„å®éªŒç»“æœåŠå‚æ•°ç­‰æˆ‘æœ‰ç©ºå†è¡¥ï¼Œæ¯”è¾ƒå¤šï¼Œéœ€è¦ä¸€äº›æ—¶é—´æ•´ç†ã€‚

| Data     | Model                    | tokenizer | æœ€å°è¯é•¿ | Min_df | ngram | binary | Use_idf | Test acc | å¤‡æ³¨                                                         |
| -------- | ------------------------ | --------- | -------- | ------ | ----- | ------ | ------- | -------- | ------------------------------------------------------------ |
| THUCNews | LR                       | lcut      | 1        | 2      | (1,1) | False  | True    | 90.61%   | C=1.0, max_iter=1000  è¯è¡¨61549ï¼›  train score:  94.22%  valid score:  89.84%  test score: 90.61%  training time:  175070.97 ms |
|          | MultinomialNB(alpha=0.3) | lcut      | 1        | 2      | (1,1) | False  | True    | 89.86%   | è¯è¡¨61549ï¼›  training time: 94.18ms                          |
|          | ComplementNB(alpha=0.8)  | lcut      | 1        | 2      | (1,1) | False  | True    | 89.88%   | è¯è¡¨61549ï¼›  training time: 98.31ms                          |
|          | SVC(C=1.0)               | lcut      | 1        | 2      | (1,1) | False  | True    | 81.49%   | è¯è¡¨61549ï¼›  ç»´åº¦200  training time:  7351155.59 ms  train score:  85.95%  valid score:  80.07%  test score: 81.49% |
|          | DT                       | lcut      | 1        | 2      | (1,1) | False  | True    | 71.19%   | max_depth=None     training time:  149216.53 ms  train score:  99.97%  valid score:  70.57%  test score: 71.19% |
|          | xgboost                  | lcut      | 1        | 2      | (1,1) | False  | True    | 90.08%   | XGBClassifier(n_estimators=2000,eta=0.3,gamma=0.1,max_depth=6,subsample=1,colsample_bytree=0.8,  nthread=10)  training time:  1551260.28 ms  train score:  99.00%  valid score:  89.34%  test score: 90.08% |
|          | KNN                      | lcut      | 1        | 2      | (1,1) | False  | True    | 83.34%   | k=5  training time:  22.14 ms  train score:  89.57%  valid score:  82.69%  test score: 83.34% |
|          |                          |           |          |        |       |        |         |          |                                                              |

 





## å¸¸è§æŠ¥é”™



## å‚è€ƒèµ„æ–™&è‡´è°¢

A Survey on Text Classification: From Shallow to Deep Learningï¼šhttps://arxiv.org/pdf/2008.00364.pdf?utm_source=summari

Deep Learning--based Text Classification: A Comprehensive Reviewï¼šhttps://arxiv.org/pdf/2004.03705.pdf

https://github.com/649453932/Chinese-Text-Classification-Pytorch

https://github.com/649453932/Bert-Chinese-Text-Classification-Pytorch

https://github.com/facebookresearch/fastText

https://github.com/brightmart/text_classification

https://github.com/kk7nc/Text_Classification

https://github.com/Tencent/NeuralNLP-NeuralClassifier

https://github.com/vandit15/Class-balanced-loss-pytorch

https://scikit-learn.org/stable/modules/model_evaluation.html#classification-metrics



## èµåŠ©æˆ‘ä»¬

æˆ‘ä»¬æ˜¯è°ï¼Ÿ

æˆ‘ä»¬æ˜¯ç¾¡é±¼æ™ºèƒ½ã€xianyu.aiã€‘ï¼Œä¸»è¦æˆå‘˜æ˜¯ä¸€ç¾¤æ¥è‡ªè€å’Œå±±ä¸‹ã€è¥¿æ¹–è¾¹ä¸Šçš„å’¸é±¼ä»¬ï¼Œå¡˜ä¸»å«ä½œç¾¡é±¼ï¼Œæƒ³åœ¨LLMsåšç‚¹æœ‰æ„ä¹‰çš„äº‹ï¼æˆ‘ä»¬çš„å£å·æ˜¯ï¼šåšOpenNLPå’ŒOpenXï¼å¸Œæœ›åœ¨OpenAIå·æ­»æˆ‘ä»¬ä¹‹å‰é€€å‡ºæ±Ÿæ¹–ï¼

OpenTextClassificationé¡¹ç›®ä¸ºç¾¡é±¼æ™ºèƒ½ã€xianyu.aiã€‘å‘èµ·çš„OpenNLPè®¡åˆ’çš„ç¬¬ä¸€ä¸ªæ­£å¼çš„å¼€æºé¡¹ç›®ï¼Œæ—¨åœ¨Open NLP for everyoneï¼åœ¨ä»¥ChatGPT/GPT4ä¸ºä»£è¡¨çš„LLMsæ—¶ä»£ï¼Œåœ¨è¢«OpenAIå·æ­»ä¹‹å‰ï¼Œåšä¸€ç‚¹æœ‰æ„ä¹‰çš„äº‹æƒ…ï¼æœªæ¥æœ‰ä¸€å¤©ï¼Œç­‰åˆ°GPT-Xå‘å¸ƒçš„æ—¶å€™ï¼Œæˆ–è®¸æœ‰äººä¼šè¯´NLPä¸å­˜åœ¨äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¯æ˜æœ‰äººæ›¾æ¥è¿‡ï¼

æœ¬é¡¹ç›®ç¬¬ä¸€ç‰ˆç”±æœ¬ç¾¡é±¼åˆ©ç”¨ä¸šåŠ¡æ—¶é—´ï¼ˆç†¬å¤œï¼‰ç‹¬ç«‹å®Œæˆï¼Œå—é™äºç²¾åŠ›å’Œç®—åŠ›ï¼Œæ‹–å»¶è‡³ä»Šï¼Œå¥½åœ¨é¡ºåˆ©å®Œæˆäº†ã€‚å¦‚æœå¤§å®¶è§‰å¾—æœ¬é¡¹ç›®å¯¹ä½ çš„NLPå­¦ä¹ /ç ”ç©¶/å·¥ä½œæœ‰æ‰€å¸®åŠ©çš„è¯ï¼Œæ±‚ä¸€ä¸ªå…è´¹çš„star! å¯Œå“¥å¯Œå§ä»¬å¯ä»¥è€ƒè™‘èµåŠ©ä¸€ä¸‹ï¼å°¤å…¶æ˜¯ç®—åŠ›ï¼Œç§Ÿå¡çš„è´¹ç”¨å·²ç»è®©æˆ‘é¢‡ä¸ºè‚‰ç–¼äº†ã€‚

<img src="https://xianyunlp.oss-cn-hangzhou.aliyuncs.com/uPic/image-20230324010955205.png" alt="image-20230324010955205" style="zoom: 25%;" />

## Starchart

[![Star History Chart](https://api.star-history.com/svg?repos=catqaq/OpenTextClassification&type=Date)](https://star-history.com/#kaixindelele/ChatPaper&Date)

## Contributors

<a href="https://github.com/catqaq/OpenTextClassification/graphs/contributors">
  <img src="https://contrib.rocks/image?repo=catqaq/OpenTextClassification" />
</a>